# 編集可能なグラフ・表の生成に関する技術調査

## 概要
PowerPoint上で後からデータを修正（Excel編集）できるグラフや、スタイルの整った表を自動生成するための技術的な課題と解決策を調査しました。

## 1. 編集可能なグラフ (Charts)

### 現状の実装について
現在 `python-pptx` で生成しているグラフは、**すでに「編集可能」です**。
PowerPoint上でグラフを右クリックし、「データの編集」を選択すると、内蔵されたExcelシートが開き、値を修正するとグラフに反映されます。

### 技術的課題と制限
`python-pptx` は優秀ですが、以下の点において制限があります。

1.  **複合グラフの新規作成が難しい**
    *   例：「棒グラフ」と「折れ線グラフ」を組み合わせた2軸グラフなどを、ゼロからコードだけで定義するAPIが不足しています。
    *   *解決策*: **テンプレート活用アプローチ**。
        *   テンプレートPPTXにあらかじめ「ダミーデータの入った複合グラフ」を配置しておく。
        *   スクリプトからは、そのグラフオブジェクトを取得し、データのみを差し替える (`chart.replace_data()`)。

2.  **細かいデザイン制御の限界**
    *   プロットエリアの正確なサイズ指定、個々のデータポイントの色変更（「最大値だけ赤くする」など）はコードが非常に複雑になるか、APIが存在しません。
    *   *解決策*: これもテンプレート側でデザインを整えておき、データ流し込みに徹するのがベターです。

3.  **3Dグラフ**
    *   `python-pptx` は3Dグラフの作成をサポートしていません。

## 2. 編集可能な表 (Tables)

### 技術的課題と制限
1.  **独自テーブルスタイルの適用**
    *   PowerPointの「テーブルスタイル（青い縞模様など）」は、既存のスタイルID（UUID）を指定することで適用可能ですが、**新しいスタイル自体を定義することはできません**。
    *   *解決策*: テンプレートファイルに含まれているスタイルを使用するか、コードでセルごとに地道に背景色を設定する方法になります。

2.  **セル内のリッチコンテンツ**
    *   セルの中に「グラフ」や「画像」を埋め込むことは仕様上できません（テキストのみ）。

## 3. 推奨される解決策（ベストプラクティス）

### パターンA：標準的なグラフ（棒・円・折れ線）
*   **手法**: 現在の `generate_slide.py` + `chart_utils.py` (python-pptx) を使用。
*   **メリット**: コードだけで完結し、完全に動的。編集も可能。

### パターンB：複雑なグラフ（2軸、複合、特殊なデザイン）
*   **手法**: **「テンプレート置換方式」**
    1.  テンプレートPPTXに、完成形のデザインで作った「ダミーグラフ」を配置し、名前（例: `TemplateChart_01`）を付けておく。
    2.  スクリプトでそのグラフを探し、データを上書きする。
*   **メリット**: デザインの再現性が完璧。コードがシンプルになる。

### パターンC：厳密なデザイン・インフォグラフィック
*   **手法**: **「画像化方式」** (NanoBanaNana / Gemini Image)
*   **メリット**: デザイン自由度が無限大。
*   **デメリット**: **編集不可**（画像として貼り付けられるため）。

## 結論
「編集可能性」を維持しつつ高度な表現を行うには、**「パターンB：テンプレート置換方式」** の導入検討をお勧めします。
現在のシステムはパターンAとCに対応済みですので、次のステップとしてパターンBの実装（データ差し替えロジック）を追加するのが有効です。
